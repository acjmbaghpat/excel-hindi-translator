<!DOCTYPE html>
<html>
<head>
  <title>Excel Hindi Translator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body style="font-family: Arial; padding:20px">

<h2>Excel Hindi Translator (Column 3 Only)</h2>

<input type="file" id="fileInput" accept=".xlsx,.xls"/>
<br><br>
<button onclick="processFile()">Upload & Translate</button>
<br><br>
<button onclick="downloadFile()">Download Translated Excel</button>

<p id="status"></p>

<script>
let workbook;
let translatedData = [];

async function translateToHindi(text) {
    const response = await fetch(
      `https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=hi&dt=t&q=${encodeURIComponent(text)}`
    );
    const data = await response.json();
    return data[0][0][0];
}

async function processFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) {
        alert("Please upload Excel file");
        return;
    }

    document.getElementById("status").innerText = "Excel file uploaded...";

    const reader = new FileReader();
    reader.onload = async function(e) {
        const data = new Uint8Array(e.target.result);
        workbook = XLSX.read(data, {type: 'array'});
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const jsonData = XLSX.utils.sheet_to_json(sheet, {header:1});

        translatedData = [];

        for (let i = 0; i < jsonData.length; i++) {
            let row = jsonData[i];

            if (i === 0) {
                translatedData.push(row);
                continue;
            }

            if (row[2]) {
                document.getElementById("status").innerText = "Translating row " + i;
                row[2] = await translateToHindi(row[2]);
            }

            translatedData.push(row);
        }

        document.getElementById("status").innerText = "Translation Complete!";
    };

    reader.readAsArrayBuffer(file);
}

function downloadFile() {
    if (translatedData.length === 0) {
        alert("No translated data found");
        return;
    }

    const ws = XLSX.utils.aoa_to_sheet(translatedData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Translated");

    XLSX.writeFile(wb, "Translated_File.xlsx");

    document.getElementById("status").innerText = "File Downloaded Successfully!";
}
</script>

</body>
</html>
